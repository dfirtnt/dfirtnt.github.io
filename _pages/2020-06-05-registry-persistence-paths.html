---
layout: page
title: Registry Persistence Paths
date: 2020-06-05 18:28:57.000000000 -04:00
categories: []
tags:
--- []
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"><br />
<html><body><br />
<table class="wrapped confluenceTable">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="confluenceTd"><strong>Persistence Registry Artifact</strong></td>
<td class="confluenceTd"><strong>Reference</strong></td>
</tr>
<tr>
<td class="confluenceTd">".*\SOFTWARE\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad$"</td>
<td class="confluenceTd"><a href="https://github.com/conix-security/zer0m0n/blob/master/signatures/persistence_autorun.py" class="external-link" rel="nofollow">https://github.com/conix-security/zer0m0n/blob/master/signatures/persistence_autorun.py</a></td>
</tr>
<tr>
<td class="confluenceTd">[WOW6432Node\]Microsoft\Cryptography\Providers\Trust\FinalPolicy\{trust provider GUID}</td>
<td class="confluenceTd"><a href="https://attack.mitre.org/wiki/Persistence" class="external-link" rel="nofollow">https://attack.mitre.org/wiki/Persistence</a></td>
</tr>
<tr>
<td class="confluenceTd">HEKY_LOCAL_MACHINE\SOFTWARE\Classes\Exefile\Shell\Open\Command\\(Default\).*"</td>
<td class="confluenceTd"><a href="https://github.com/conix-security/zer0m0n/blob/master/signatures/persistence_autorun.py" class="external-link" rel="nofollow">https://github.com/conix-security/zer0m0n/blob/master/signatures/persistence_autorun.py</a></td>
</tr>
<tr>
<td class="confluenceTd">HEKY_LOCAL_MACHINE\System\CurrentControlSet\Control\BootVerificationProgram</td>
<td class="confluenceTd"><a href="https://www.forensicswiki.org/wiki/Windows_Registry" class="external-link" rel="nofollow">https://www.forensicswiki.org/wiki/Windows_Registry</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_CLASSES_ROOT\</td>
<td class="confluenceTd"><a href="https://attack.mitre.org/wiki/Persistence" class="external-link" rel="nofollow">https://attack.mitre.org/wiki/Persistence</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_CLASSES_ROOT\[handler]\shell\[action]\command</td>
<td class="confluenceTd"><a href="https://attack.mitre.org/wiki/Persistence" class="external-link" rel="nofollow">https://attack.mitre.org/wiki/Persistence</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_CLASSES_ROOT\textfile\shell\open\command</td>
<td class="confluenceTd"><a href="https://resources.infosecinstitute.com/common-malware-persistence-mechanisms/" class="external-link" rel="nofollow">https://resources.infosecinstitute.com/common-malware-persistence-mechanisms/</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_CURRENT_USER\Control Panel\Desktop\</td>
<td class="confluenceTd"><a href="https://attack.mitre.org/wiki/Technique/T1180" class="external-link" rel="nofollow">https://attack.mitre.org/wiki/Technique/T1180</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_CURRENT_USER\Software\Microsoft\Office test\Special\Perf</td>
<td class="confluenceTd"><a href="https://attack.mitre.org/wiki/Persistence" class="external-link" rel="nofollow">https://attack.mitre.org/wiki/Persistence</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows\load</td>
<td class="confluenceTd">Sysinternals AutoRuns</td>
</tr>
<tr>
<td class="confluenceTd">HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</td>
<td class="confluenceTd"><a href="https://attack.mitre.org/wiki/Technique/T1004" class="external-link" rel="nofollow">https://attack.mitre.org/wiki/Technique/T1004</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</td>
<td class="confluenceTd"><a href="https://resources.infosecinstitute.com/common-malware-persistence-mechanisms/#gref" class="external-link" rel="nofollow">https://resources.infosecinstitute.com/common-malware-persistence-mechanisms/#gref</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</td>
<td class="confluenceTd"><a href="https://resources.infosecinstitute.com/common-malware-persistence-mechanisms/#gref" class="external-link" rel="nofollow">https://resources.infosecinstitute.com/common-malware-persistence-mechanisms/#gref</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</td>
<td class="confluenceTd"><a href="https://technet.microsoft.com/en-us/library/ee851671.aspx" class="external-link" rel="nofollow">https://technet.microsoft.com/en-us/library/ee851671.aspx</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce</td>
<td class="confluenceTd"><a href="https://technet.microsoft.com/en-us/library/ee851671.aspx" class="external-link" rel="nofollow">https://technet.microsoft.com/en-us/library/ee851671.aspx</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SOFTWARE[\WOW6432Node\]Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllGetSignedDataMsg\{SIP_GUID}</td>
<td class="confluenceTd"><a href="https://attack.mitre.org/wiki/Persistence" class="external-link" rel="nofollow">https://attack.mitre.org/wiki/Persistence</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SOFTWARE\[WOW6432Node\]Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllVerifyIndirectData\{SIP_GUID}</td>
<td class="confluenceTd"><a href="https://attack.mitre.org/wiki/Persistence" class="external-link" rel="nofollow">https://attack.mitre.org/wiki/Persistence</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\Software\Classes\</td>
<td class="confluenceTd"><a href="https://resources.infosecinstitute.com/common-malware-persistence-mechanisms/#gref" class="external-link" rel="nofollow">https://resources.infosecinstitute.com/common-malware-persistence-mechanisms/#gref</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Active Setup\Installed Components</td>
<td class="confluenceTd">Sysinternals AutoRuns</td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Netsh</td>
<td class="confluenceTd"><a href="https://attack.mitre.org/wiki/Persistence" class="external-link" rel="nofollow">https://attack.mitre.org/wiki/Persistence</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options/&lt;executable&gt;</td>
<td class="confluenceTd"><a href="https://attack.mitre.org/wiki/Persistence" class="external-link" rel="nofollow">https://attack.mitre.org/wiki/Persistence</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\IniFileMapping\system.ini\boot</td>
<td class="confluenceTd"><a href="https://resources.infosecinstitute.com/common-malware-persistence-mechanisms/#gref" class="external-link" rel="nofollow">https://resources.infosecinstitute.com/common-malware-persistence-mechanisms/#gref</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS NT\CURRENTVERSION\SCHEDULE\TASKCACHE\TASKS\</td>
<td class="confluenceTd"><a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/troj_kilim.efld" class="external-link" rel="nofollow">https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/troj_kilim.efld</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS NT\CURRENTVERSION\SCHEDULE\TASKCACHE\TREE\</td>
<td class="confluenceTd"><a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/troj_kilim.efld" class="external-link" rel="nofollow">https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/troj_kilim.efld</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\SvcHost</td>
<td class="confluenceTd"><a href="https://www.bleepingcomputer.com/tutorials/how-malware-hides-as-a-service/" class="external-link" rel="nofollow">https://www.bleepingcomputer.com/tutorials/how-malware-hides-as-a-service/</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows</td>
<td class="confluenceTd"><a href="https://technet.microsoft.com/en-us/library/ee851671.aspx" class="external-link" rel="nofollow">https://technet.microsoft.com/en-us/library/ee851671.aspx</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs</td>
<td class="confluenceTd"><a href="https://threatvector.cylance.com/windows-registry-persistence-part-2-the-run-keys-and-search-order.html" class="external-link" rel="nofollow">https://threatvector.cylance.com/windows-registry-persistence-part-2-the-run-keys-and-search-order.html</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows\IconServiceLib</td>
<td class="confluenceTd">Sysinternals AutoRuns</td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\</p>
</td>
<td class="confluenceTd">
<ul style="margin-left:.2in;">
<li><span>Winlogon\Notify - points to notification package DLLs that handle Winlogon events</span></li>
<li><span>Winlogon\Userinit - points to userinit.exe, the user initialization program executed when a user logs on</span></li>
<li><span>Winlogon\Shell - points to explorer.exe, the system shell executed when a user logs on</span></li>
</ul>
</td>
<td class="confluenceTd"><a href="https://attack.mitre.org/wiki/Technique/T1004" class="external-link" rel="nofollow">https://attack.mitre.org/wiki/Technique/T1004</a></td>
</tr>
<tr>
<td colspan="1" class="confluenceTd">
<span>HKLM\Software[Wow6432Node]Microsoft\Windows NT\CurrentVersion\Winlogon\</span></p>
</td>
<td colspan="1" class="confluenceTd">
<ul style="margin-left:.2in;">
<li><span>Winlogon\Notify - points to notification package DLLs that handle Winlogon events</span></li>
<li><span>Winlogon\Userinit - points to userinit.exe, the user initialization program executed when a user logs on</span></li>
<li><span>Winlogon\Shell - points to explorer.exe, the system shell executed when a user logs on</span></li>
</ul>
</td>
<td colspan="1" class="confluenceTd"><a href="https://attack.mitre.org/wiki/Technique/T1004" class="external-link" rel="nofollow">https://attack.mitre.org/wiki/Technique/T1004</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\VmApplet</td>
<td class="confluenceTd">Sysinternals AutoRuns</td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects</td>
<td class="confluenceTd"><a href="https://digital-forensics.sans.org/summit-archives/2012/taking-registry-analysis-to-the-next-level.pdf" class="external-link" rel="nofollow">https://digital-forensics.sans.org/summit-archives/2012/taking-registry-analysis-to-the-next-level.pdf</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</td>
<td class="confluenceTd"><a href="https://resources.infosecinstitute.com/common-malware-persistence-mechanisms/#gref" class="external-link" rel="nofollow">https://resources.infosecinstitute.com/common-malware-persistence-mechanisms/#gref</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</td>
<td class="confluenceTd"><a href="https://resources.infosecinstitute.com/common-malware-persistence-mechanisms/#gref" class="external-link" rel="nofollow">https://resources.infosecinstitute.com/common-malware-persistence-mechanisms/#gref</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown</td>
<td class="confluenceTd">Sysinternals AutoRuns</td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Startup</td>
<td class="confluenceTd">Sysinternals AutoRuns</td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</td>
<td class="confluenceTd"><a href="https://tech-zealots.com/malware-analysis/malware-persistence-techniques-hackers-pandora-box/" class="external-link" rel="nofollow">https://tech-zealots.com/malware-analysis/malware-persistence-techniques-hackers-pandora-box/</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</td>
<td class="confluenceTd">Sysinternals AutoRuns</td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce</td>
<td class="confluenceTd">Sysinternals AutoRuns</td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnceEx</td>
<td class="confluenceTd">Sysinternals AutoRuns</td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices</td>
<td class="confluenceTd">Sysinternals AutoRuns</td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</td>
<td class="confluenceTd"><a href="https://tech-zealots.com/malware-analysis/malware-persistence-techniques-hackers-pandora-box/" class="external-link" rel="nofollow">https://tech-zealots.com/malware-analysis/malware-persistence-techniques-hackers-pandora-box/</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad</td>
<td class="confluenceTd"><a href="https://threatvector.cylance.com/en_us/home/windows-registry-persistence-part-2-the-run-keys-and-search-order.html" class="external-link" rel="nofollow">https://threatvector.cylance.com/en_us/home/windows-registry-persistence-part-2-the-run-keys-and-search-order.html</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Active Setup\Installed Components</td>
<td class="confluenceTd">Sysinternals AutoRuns</td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Run</td>
<td class="confluenceTd">Sysinternals AutoRuns</td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SYSTEM\ControlSet002\Control\Session Manager\BootExecute</td>
<td class="confluenceTd"><a href="https://digital-forensics.sans.org/summit-archives/2012/taking-registry-analysis-to-the-next-level.pdf" class="external-link" rel="nofollow">https://digital-forensics.sans.org/summit-archives/2012/taking-registry-analysis-to-the-next-level.pdf</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\hivelist</td>
<td class="confluenceTd"><a href="https://threatvector.cylance.com/en_us/home/windows-registry-persistence-part-2-the-run-keys-and-search-order.html" class="external-link" rel="nofollow">https://threatvector.cylance.com/en_us/home/windows-registry-persistence-part-2-the-run-keys-and-search-order.html</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\Security Packages</td>
<td class="confluenceTd"><a href="https://attack.mitre.org/wiki/Technique/T1101" class="external-link" rel="nofollow">https://attack.mitre.org/wiki/Technique/T1101</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</td>
<td class="confluenceTd"><a href="https://attack.mitre.org/wiki/Technique/T1101" class="external-link" rel="nofollow">https://attack.mitre.org/wiki/Technique/T1101</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\AlternateShell</td>
<td class="confluenceTd">Sysinternals AutoRuns</td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\BootExecute</td>
<td class="confluenceTd"><a href="https://threatvector.cylance.com/en_us/home/windows-registry-persistence-part-2-the-run-keys-and-search-order.html" class="external-link" rel="nofollow">https://threatvector.cylance.com/en_us/home/windows-registry-persistence-part-2-the-run-keys-and-search-order.html</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\KnownDLLs</td>
<td class="confluenceTd"><a href="https://resources.infosecinstitute.com/common-malware-persistence-mechanisms/#gref" class="external-link" rel="nofollow">https://resources.infosecinstitute.com/common-malware-persistence-mechanisms/#gref</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\StartupPrograms</td>
<td class="confluenceTd">Sysinternals AutoRuns</td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services</td>
<td class="confluenceTd"><a href="https://attack.mitre.org/wiki/Technique/T1058" class="external-link" rel="nofollow">https://attack.mitre.org/wiki/Technique/T1058</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\W32Time\TimeProviders\</td>
<td class="confluenceTd"><a href="https://attack.mitre.org/wiki/Technique/T1209" class="external-link" rel="nofollow">https://attack.mitre.org/wiki/Technique/T1209</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_USERS\****\Software\Microsoft\Windows\CurrentVersion\RunOnce</td>
<td class="confluenceTd"><a href="https://threatvector.cylance.com/en_us/home/windows-registry-persistence-part-2-the-run-keys-and-search-order.html" class="external-link" rel="nofollow">https://threatvector.cylance.com/en_us/home/windows-registry-persistence-part-2-the-run-keys-and-search-order.html</a></td>
</tr>
<tr>
<td class="confluenceTd">HKEY_USERS\***\Software\Microsoft\Windows\CurrentVersion\Run</td>
<td class="confluenceTd"><a href="https://threatvector.cylance.com/en_us/home/windows-registry-persistence-part-2-the-run-keys-and-search-order.html" class="external-link" rel="nofollow">https://threatvector.cylance.com/en_us/home/windows-registry-persistence-part-2-the-run-keys-and-search-order.html</a></td>
</tr>
<tr>
<td class="confluenceTd">HEKY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{GUID}</td>
<td class="confluenceTd"><a href="https://digital-forensics.sans.org/summit-archives/2012/taking-registry-analysis-to-the-next-level.pdf" class="external-link" rel="nofollow">https://digital-forensics.sans.org/summit-archives/2012/taking-registry-analysis-to-the-next-level.pdf</a></td>
</tr>
<tr>
<td class="confluenceTd">HEKY_LOCAL_MACHINE\SOFTWARE\Microsoft\Command Processor\Auto Run</td>
<td class="confluenceTd"><a href="https://digital-forensics.sans.org/summit-archives/2012/taking-registry-analysis-to-the-next-level.pdf" class="external-link" rel="nofollow">https://digital-forensics.sans.org/summit-archives/2012/taking-registry-analysis-to-the-next-level.pdf</a></td>
</tr>
<tr>
<td class="confluenceTd">HEKY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts</td>
<td class="confluenceTd"><a href="https://digital-forensics.sans.org/summit-archives/2012/taking-registry-analysis-to-the-next-level.pdf" class="external-link" rel="nofollow">https://digital-forensics.sans.org/summit-archives/2012/taking-registry-analysis-to-the-next-level.pdf</a></td>
</tr>
<tr>
<td class="confluenceTd">HEKY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shared Task Scheduler</td>
<td class="confluenceTd"><a href="https://digital-forensics.sans.org/summit-archives/2012/taking-registry-analysis-to-the-next-level.pdf" class="external-link" rel="nofollow">https://digital-forensics.sans.org/summit-archives/2012/taking-registry-analysis-to-the-next-level.pdf</a></td>
</tr>
</tbody>
</table>
<p></body></html></p>
